<?php
/**
 * Created by PhpStorm.
 * User: gaupoit
 * Date: 9/26/18
 * Time: 19:40
 */

class PdaCustomServer extends Wpup_UpdateServer {
	/**
	 * Override metedata.
	 *
	 * @param array        $meta Metadata.
	 * @param Wpup_Request $request Request object.
	 *
	 * @return array|void
	 */
	protected function filterMetadata( $meta, $request ) {
		$meta = parent::filterMetadata( $meta, $request ); // TODO: Change the autogenerated stub.
		unset( $meta['download_url'] );
		return $meta;
	}
	
	/**
	 * Override action download
	 *
	 * @param Wpup_Request $request Request object.
	 */
	protected function actionDownload( Wpup_Request $request ) {
		$this->exitWithError( 'Downloads are disable', 403 );
	}
	
	/**
	 * Override load package for
	 *
	 * @param Wpup_Request $request Request object.
	 */
	protected function loadPackageFor( $request ) {
		parent::loadPackageFor( $request );
	}
	
	/**
	 * Override authorization checking
	 *
	 * @param mixed $request Request object.
	 */
	protected function checkAuthorization( $request ) {
		$this->logRequest( $request );
		//TODO: send the request to API to check if the license is valid.
		exit();
	}
}